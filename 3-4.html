<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="./public/favicon.ico" />
  <meta http-equiv="cache-control" content="no-cache">
  <title>JavaScript-syntax-testing</title>
  <link rel="stylesheet" href=" https://necolas.github.io/normalize.css/8.0.1/normalize.css" />
  <link rel="stylesheet" href="./hightlight/default.min.css" />
  <link rel="stylesheet" href="./css/main.css" />
  <link rel="stylesheet" href="./css/copybutton.css" />
  <link rel="stylesheet" href="./css/hightlight.css" />
  <script src="./hightlight/hightlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script>

</head>

<body>
  <nav>
    <h1><a href="index.html">現代 Javascript 實務應用</a></h1>
  </nav>
  <main>
    <aside></aside>
    <section>
      <h2>3-4 修飾器</h2>

      <h3 id="3-4-1">3-4-1 初談 JavaScript 修飾器</h3>
      <pre><code class="language-js">
 
@decorators.frozen 是有效的修飾器
@decorators.frozen(true )是有效的修飾器
@decorators().frozen() 語法錯誤
@decorators['frozen'] 語法錯誤

 // class 類別宣告和類別成員宣告處,可選擇加入多个修飾器,或不加入亦可。

@inanimate
class Car {} 

@expensive
@speed('fast') 
class Lamborghini extends Car {}

class View {
@throttle(200) // 最多每隔 200ms 便會呼叫 reconcile 一次
reconcile() {}
}
</code></pre>

      <pre><code class="language-js">

interface MemberDescriptor {
  kind: "Property"
  key: string,
  isStatic: boolean,
  descriptor: PropertyDescriptor,
  extras?: MemberDescriptor[]
  finisher?: (constructor): void;
}
</code></pre>
      <pre><code class="language-js">
function readonly({ descriptor, ...rest }) {
    return {
    ...rest,
    descriptor: {
      ...descriptor,
      writable: false
    }
  }
}
</code></pre>
      <pre><code class="language-js">
function readonlyMembers(ctor, heritage, members) {
  return members.map(member =&gt; readonly(member))
}
</code></pre>
      <h3 id="3-4-3">3-4-3 使用案例:C#的Attributes</h3>
      <p>
        依賴反射遊戲管理 NPC
      </p>

      <h3 id="3-4-4">3-4-4 於 JavaScript 中標記特性</h3>

      <pre><code class="language-js">
class Dog {
  @commandProperty('game-master')
}

</code></pre>
      <pre><code class="language-js">
function commandProperty(writeLevel, readLevel = writeLevel){
  return ({ key, ...rest }) =&gt; ({
    key,
    rest,
    finisher(ctor) {
      const symbol = Symbol.for(' commandProperties')
      const commandPropertyDescriptor = {
        key,
        readLevel,
        writeLevel
      }
      if(!ctor[symbol]){
        ctor[symbol] = []
      }
      ctor[symbol].push(commandPropertyDescriptor)
    }
  })
}
</code></pre>
      <pre><code class="language-js">
function getCommandProperties(ctor) {
  const symbol = Symbol.for('commandProperties')
  const properties = ctor[symbol] || []
  return [...properties ]
} 
getCommandProperties(Dog)
// [{
//    key: 'name',
//    readLevel: 'game-master',
//    writeLevel:  'game-master' 
// }]
      </code></pre>

    </section>

  </main>
</body>
<script type="module" src="./js/main.js"></script>


</html>